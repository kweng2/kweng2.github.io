<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Intro To D3, Transition Tween</title><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@" /><meta name="twitter:title" content="Intro To D3, Transition Tween" /><meta name="twitter:description" content="While learning to use D3, I encountered difficulties understanding the basics of what a tween is, and how to implement it."><meta name="description" content="While learning to use D3, I encountered difficulties understanding the basics of what a tween is, and how to implement it."><link rel="icon" href="/assets/favicon.png"><link rel="apple-touch-icon" href="/assets/touch-icon.png"><link rel="stylesheet" href="//code.cdn.mozilla.net/fonts/fira.css"><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/notes/Intro-To-D3"><link rel="alternate" type="application/atom+xml" title="Everything JS" href="/feed.xml" /></head><body><aside class="logo"> <a href="/"> <img src="http://i.imgur.com/lXpakuT.jpg?1" class="gravatar" width="80px"> </a> <span class="logo-prompt">Back to Home</span></aside><main> <noscript><style> article .footnotes { display: block; }</style></noscript><article><div class="center"><h1>Intro To D3, Transition Tween</h1><time>December 6, 2015</time></div><div class="divider"></div><p>While learning to use D3, I encountered difficulties understanding the basics of what a tween is, and how to implement it.</p><p>First, let’s look at <a href="https://github.com/mbostock/d3/wiki/Transitions">this</a></p><p>This is an extremely helpful document, but can be overwhelming. So, let’s explore the very basic idea of tween:</p><p>Suppose a dot needs to move from point a to point b on the screen over some period of time. This dot has a starting (x,y) coordinate and an ending (x,y) coordinate. While the dot is moving it will be at a number of intermediate positions. These intermediate positions can be found by parameterizing with time, like so:</p><div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">intermediateX</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startX</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endX</span> <span class="o">-</span> <span class="nx">startX</span><span class="p">)</span><span class="o">*</span><span class="nx">t</span>
<span class="nx">intermediateY</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startY</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endY</span> <span class="o">-</span> <span class="nx">startY</span><span class="p">)</span><span class="o">*</span><span class="nx">t</span>
</code></pre></div><p>We can say that its intermediate position is a function of time, and is equal to its starting position plus time multiplied by the difference between its end position and starting position, where time is between zero and one.</p><div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">intermediateX</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startX</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endX</span> <span class="o">-</span> <span class="nx">startX</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span> <span class="o">=</span> <span class="nx">startX</span>
<span class="nx">intermediateX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startX</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endX</span> <span class="o">-</span> <span class="nx">startX</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span> <span class="o">=</span> <span class="nx">endX</span>
<span class="nx">intermediateY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startY</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endY</span> <span class="o">-</span> <span class="nx">startY</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span> <span class="o">=</span> <span class="nx">startY</span>
<span class="nx">intermediateY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nx">startY</span> <span class="o">+</span> <span class="p">(</span><span class="nx">endY</span> <span class="o">-</span> <span class="nx">startY</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span> <span class="o">=</span> <span class="nx">endY</span>
</code></pre></div><p>So we see that as time goes from 0 to 1, the dot goes from its start to end.</p><p>How do we access all these intermediate positions? We can attach a custom tween function to a transition. This custom tween function must return a function. Inside the returning function, we are looking at a snapshot of the dot, during its transition.</p><div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">d3Selection</span><span class="p">.</span><span class="nx">transition</span><span class="p">().</span><span class="nx">duration</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="s1">'custom'</span><span class="p">,</span> <span class="nx">customTween</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">customTween</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span>
    <span class="c1">// everything in here is at a intermediate position and time</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div><p>It is important to note that the parameter <code class="highlighter-rouge">t</code>, input of the returning function, as well as the parameter we discussed above, is not actually time, it’s a parameter value between 0 and 1. It’s easy to imagine a transition that takes longer than 1 second, or shorter. So this time variable is simply a parameterization of the start/end time. At 0, the transition is starting; and at 1, the transition has just completed. How long this transition takes depends on the variable <code class="highlighter-rouge">n</code> in duration(n).</p><p>Usually, the object that is transitioning is of interest, so we might want to query it during the transition. We can do that by creating a closure scope prior to the returning function like this:</p><div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">customTween</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// we can still access obj here, for example:</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div><p>Hope that helps as an introduction to using tween for D3’s powerful transition function.</p><p>One last note, the t parameter in the returning function will only be between 0 and 1. How it changes relative to real-world time is controlled by the easing function, which you can read about <a href="https://github.com/mbostock/d3/wiki/Transitions#easing">here</a>.</p></article><div class="back"> <a href="/">Back</a></div></main></body></html>